<!DOCTYPE html>
<html>
  <head>
    <title>JSON Interface</title>

    <script>
    // helper
      function printTo(str){
        var temp = document.getElementById("print_1").innerHTML;
        document.getElementById("print_1").innerHTML = temp + str;

      }
    </script>
    <script>
    function Wiera(){
      this.wieraPolicy = {};
      this.idKey = "id";
      this.descKey = "desc";
      this.localInstancesKey = "local_instances";
      this.toJSON = function(){
        return JSON.stringify(this.wieraPolicy);
      }
      this.configuration = function(id, desc){
        this.wieraPolicy[this.idKey] = id;
        this.wieraPolicy[this.descKey] = desc;
        this.wieraPolicy[this.localInstancesKey] = null;
      }
      this.addARegionalTiera = function(region, tieraName){

       if (this.wieraPolicy[this.localInstancesKey]){
        //  this.wieraPolicy[this.localInstancesKey][region][tieraName] = null;
        }else{
          var obj = new Object();
          obj[region] = new Object();
          obj[region][tieraName] = null;
          this.wieraPolicy[this.localInstancesKey] = obj;
        }
        return new Tiera(this, region, tieraName);
      }

      //this.addATieraInstanceTo(region, tieraName)
    }

    function Tiera(wiera, region, tieraName){
      this.wiera = wiera;
      this.region = region;
      this.tieraName = tieraName;
      this.wiera.wieraPolicy[this.wiera.localInstancesKey][region][tieraName] = new Array();
      this.tieraSeverOrder = new Array();
      this.tierName = "tier_name";
      this.tierSize = "tier_size";
      this.tierType = "tier_type";
      this.tierLocation = "tier_location";
      this.tierExpectedLatency = "tier_expected_latency";
      this.addATier = function initialnInstance(name, size, type, location, expected_latency){
        var temp = this.wiera.wieraPolicy[this.wiera.localInstancesKey][this.region];
        if(temp[this.tieraName].length != this.tieraSeverOrder.length){
          return;
        }
        var len = this.tieraSeverOrder.length;
        var assemble = new Object();
        assemble[this.tierName] = name;
        assemble[this.tierSize] = size;
        assemble[this.tierType] = type;
        assemble[this.tierLocation] = location;
        assemble[this.tierExpectedLatency] = expected_latency;

        this.tieraSeverOrder[len] = name;
        temp[this.tieraName][len] = assemble;
        
      }
    }





    </script>
  </head>
  <body>

    <p id = "print_1"></p>
    <script>
      var wiera = new Wiera();
      wiera.configuration("example", "example for demostration");
      var tiera1 = wiera.addARegionalTiera("us-east", "storage_tiers");
      tiera1.addATier("memcached", "256MB", 0, "127.0.0.1", 0);
      tiera1.addATier("memcached", "256MB", 0, "127.0.0.1", 0);
      printTo(wiera.toJSON());
    </script>



  </body>
</html>
